# 信号（一）

## 中断

中断是系统对于异步事件的响应

### 中断分类
- 硬件中断(外部中断)：外部中断是指由外部设备通过硬件请求的方式产生的中断，也称为硬件中断
- 软件中断（内部中断)：内部中断是由CPU运行程序错误或执行内部程序调用引起的一种中断，也称为软件中断。

## 信号
- 信号是UNIX系统响应某些状况而产生的事件，进程在接收到信号时会采取相应的行动。
- 信号是因为某些错误条件而产生的，比如内存段冲突、浮点处理器错误或者非法指令等。
- 信号是在软件层次上对中断的一种模拟，所以通常把它称为是软中断。
- kill -l命令查看信号名称，man 7 signal查看详细手册
- 信号的名称是在头文件signal.h里定义的
### 常用的信号
信号名称|描述
-|-
SIGABRT|进程停止运行
SIGALRM|警告钟
SIGFPE|算述运算例外
SIGHUP|系统桂断
SIGILL|非法指令
SIGINT|终端中断
SIGKI LL|停止进程（此信号不能被忽略或捕获)
SIGPIPE|向没有读者的管道写入数据
SIGSEGV|无效内存段访问


## 信号与中断

### 信号与中断的相似点:
- 采用了相同的异步通信方式;
- 当检测出有信号或中断请求时，都暂停正在执行的程序而转去执行相应的处理程序;
- 都在处理完毕后返回到原来的断点;
- 对信号或中断都可进行屏蔽。
### 信号与中断的区别:
- 中断有优先级，而信号没有优先级，所有的信号都是平等的;
- 信号处理程序是在用户态下运行的，而中断处理程序是在核心态下运行;
- 中断响应是及时的，而信号响应通常都有较大的时间延迟

## 进程对信号的反应

- 忽略信号
  - 不采取任何操作、有两个信号不能被忽略:SIGKILL和SIGSTOP。
- 捕获并处理信号
  - 内核中断正在执行的代码，转去执行先前注册过的处
- 执行默认操作
  - 默认操作通常是终止进程，这取决于被发送的信号。


## signal
功能：给程序安装一个信号处理程序
```
typedef void (*_sighandler_t)(int);
#define SlG_ERR((_sighandler_t) -1)
#define SlG_DFL ((__sighandler_t )0)
#define slG_IGN((__sighandler_t)1)
```
- 函数原型:
  - _sighandler_t signal(int signum,__sighandler_t handler);
- 参数
  - signal是一个带signum和handler两个参数的函数，准备捕捉或屏蔽的信号由参数signum给出，接收到指定信号时将要调用的函数由handler给出
  - handler这个函数必须有一个int类型的参数（即接收到的信号代码)，它本身的类型是void
  - handler也可以是下面两个特殊值:SIG_IGN 屏蔽该信号; SIG_DFL恢复默认行为
